# Automatic git tagging script (based on package.json)
AUTO_TAG() {
  # Get current version from package.json
  CURRENT_VERSION=$(node -p "require('./package.json').version")
  
  # Extract version numbers
  IFS='.' read -r MAJOR MINOR PATCH <<< "$CURRENT_VERSION"
  
  # Increment patch version
  NEW_PATCH=$((PATCH + 1))
  NEW_VERSION="${MAJOR}.${MINOR}.${NEW_PATCH}"
  NEW_TAG="v${NEW_VERSION}"
  
  echo "ðŸ“¦ Creating new tag: v${CURRENT_VERSION} â†’ ${NEW_TAG}"
  
  # Update package.json first
  npm version --no-git-tag-version "$NEW_VERSION"
  git add package.json
  
  # Create git tag
  git tag "$NEW_TAG"
}

echo "HUSKY âš™ï¸ Running build before staging..." \
&& npm run build \
&& git add dist \
&& npm run lint \
&& npm run test \
&& AUTO_TAG \
&& echo "HUSKY âš™ï¸ Ready to push with new version!" 
